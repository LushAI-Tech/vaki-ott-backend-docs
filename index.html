<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Integration Guide - Vaki OTT API</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #635bff;
            --primary-dark: #5851ea;
            --secondary: #0a2540;
            --text: #0a2540;
            --text-light: #425466;
            --border: #e3e8ef;
            --bg: #ffffff;
            --bg-light: #f6f9fc;
            --code-bg: #1e1e1e;
            --sidebar-width: 280px;
            --header-height: 64px;
        }

        [data-theme="dark"] {
            --primary: #7c75ff;
            --primary-dark: #6b64ff;
            --secondary: #1a2a3a;
            --text: #e4e6eb;
            --text-light: #b0b3b8;
            --border: #3a3b3c;
            --bg: #18191a;
            --bg-light: #242526;
            --code-bg: #1e1e1e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: var(--text);
            background: var(--bg);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: var(--bg);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            z-index: 1000;
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text);
            transition: all 0.2s;
            width: 36px;
            height: 36px;
        }

        .theme-toggle:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }

        .theme-toggle svg {
            width: 18px;
            height: 18px;
        }

        .menu-toggle {
            display: none;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 0.5rem;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            color: var(--text);
            transition: all 0.2s;
            width: 36px;
            height: 36px;
        }

        .menu-toggle:hover {
            background: var(--bg-light);
            border-color: var(--primary);
        }

        .menu-toggle svg {
            width: 20px;
            height: 20px;
        }

        /* Layout */
        .container {
            display: flex;
            margin-top: var(--header-height);
            min-height: calc(100vh - var(--header-height));
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg);
            border-right: 1px solid var(--border);
            position: fixed;
            left: 0;
            top: var(--header-height);
            bottom: 0;
            overflow-y: auto;
            padding: 2rem 0;
            z-index: 100;
        }

        /* Sidebar overlay for mobile */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: var(--header-height);
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 99;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }

        .sidebar-nav {
            padding: 0 1.5rem;
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-light);
            margin-bottom: 0.75rem;
            padding: 0 1.5rem;
        }

        .nav-link {
            display: block;
            padding: 0.5rem 1.5rem;
            color: var(--text);
            text-decoration: none;
            font-size: 0.875rem;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .nav-link:hover {
            background: var(--bg-light);
            color: var(--primary);
        }

        .nav-link.active {
            border-left-color: var(--primary);
            background: var(--bg-light);
            color: var(--primary);
            font-weight: 500;
        }

        .nav-link.sub {
            padding-left: 2.5rem;
            font-size: 0.8125rem;
            color: var(--text-light);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 3rem 4rem;
            max-width: 900px;
        }

        .section {
            margin-bottom: 4rem;
            scroll-margin-top: calc(var(--header-height) + 2rem);
        }

        .section h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .section h2 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            color: var(--text);
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border);
        }

        .section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .section p {
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .section ul, .section ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .section li {
            margin-bottom: 0.5rem;
        }

        /* Code Blocks */
        pre {
            background: var(--code-bg);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            border: 1px solid var(--border);
        }

        code {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        pre code {
            color: #d4d4d4;
        }

        .inline-code {
            background: var(--bg-light);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.875em;
            color: var(--primary);
            border: 1px solid var(--border);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            font-size: 0.875rem;
        }

        table th {
            background: var(--bg-light);
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text);
            border-bottom: 2px solid var(--border);
        }

        table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border);
            color: var(--text-light);
        }

        table tr:hover {
            background: var(--bg-light);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .badge-get {
            background: #e3f2fd;
            color: #1976d2;
        }

        [data-theme="dark"] .badge-get {
            background: #1e3a5f;
            color: #64b5f6;
        }

        .badge-post {
            background: #e8f5e9;
            color: #388e3c;
        }

        [data-theme="dark"] .badge-post {
            background: #1e3a2e;
            color: #81c784;
        }

        .badge-put {
            background: #fff3e0;
            color: #f57c00;
        }

        [data-theme="dark"] .badge-put {
            background: #4a3a1e;
            color: #ffb74d;
        }

        .badge-delete {
            background: #ffebee;
            color: #d32f2f;
        }

        [data-theme="dark"] .badge-delete {
            background: #4a1e1e;
            color: #e57373;
        }

        .badge-patch {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        [data-theme="dark"] .badge-patch {
            background: #3a1e3a;
            color: #ba68c8;
        }

        /* Endpoint Cards */
        .endpoint {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            transition: all 0.2s;
        }

        .endpoint:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .endpoint-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            user-select: none;
        }

        .endpoint-header:hover {
            opacity: 0.8;
        }

        .endpoint-toggle {
            margin-left: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            transition: transform 0.2s, background-color 0.2s;
            color: var(--text-light);
        }

        .endpoint-toggle:hover {
            background: var(--bg-light);
        }

        .endpoint-toggle svg {
            width: 16px;
            height: 16px;
            transition: transform 0.2s;
        }

        .endpoint.collapsed .endpoint-toggle svg {
            transform: rotate(-90deg);
        }

        .endpoint-content {
            overflow: hidden;
            transition: max-height 0.3s ease-out, opacity 0.2s ease-out;
            max-height: 5000px;
            opacity: 1;
        }

        .endpoint.collapsed .endpoint-content {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }

        .endpoint-description {
            margin-bottom: 1rem;
            color: var(--text-light);
        }

        .endpoint.collapsed .endpoint-description {
            margin-bottom: 0;
        }

        .endpoint-method {
            font-weight: 600;
            font-size: 0.875rem;
        }

        .endpoint-path {
            font-family: 'SF Mono', Monaco, monospace;
            color: var(--text);
            font-size: 0.9375rem;
        }

        .endpoint-description {
            color: var(--text-light);
            margin-bottom: 1rem;
        }

        /* Info Boxes */
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1rem 1.5rem;
            border-radius: 4px;
            margin: 1.5rem 0;
        }

        [data-theme="dark"] .info-box {
            background: #1e3a5f;
            color: #e4e6eb;
        }

        .info-box.warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }

        [data-theme="dark"] .info-box.warning {
            background: #4a3a1e;
            color: #e4e6eb;
        }

        .info-box.success {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        [data-theme="dark"] .info-box.success {
            background: #1e3a2e;
            color: #e4e6eb;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .menu-toggle {
                display: flex;
            }

            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
                box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 2rem;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 1rem;
            }

            .main-content {
                padding: 1.5rem;
            }

            .section h1 {
                font-size: 2rem;
            }
        }

        /* Scrollbar */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: var(--bg-light);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }
    </style>
</head>
<body>
    <header class="header">
        <div style="display: flex; align-items: center; gap: 1rem;">
            <button class="menu-toggle" id="menuToggle" aria-label="Toggle navigation menu">
                <svg id="menuIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
                <svg id="closeIcon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <h1>Frontend Integration Guide</h1>
        </div>
        <div class="header-actions">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
                <svg id="sunIcon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                <svg id="moonIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
            </button>
        </div>
    </header>

    <!-- Sidebar overlay for mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <a href="#overview" class="nav-link">Overview</a>
                    <a href="#base-url" class="nav-link">Base URL</a>
                    <a href="#authentication" class="nav-link">Authentication</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">User Service</div>
                    <a href="#otp-api" class="nav-link sub">OTP API</a>
                    <a href="#auth-api" class="nav-link sub">Authentication</a>
                    <a href="#users-api" class="nav-link sub">Users & Profiles</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Payment Service</div>
                    <a href="#payments-api" class="nav-link sub">Payments & Rentals</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Content Service</div>
                    <a href="#movies-api" class="nav-link sub">Movies</a>
                    <a href="#reels-api" class="nav-link sub">Reels</a>
                    <a href="#sections-api" class="nav-link sub">Sections</a>
                    <a href="#stream-api" class="nav-link sub">Streaming</a>
                    <a href="#references-api" class="nav-link sub">References</a>
                    <a href="#people-api" class="nav-link sub">People</a>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <!-- Overview -->
            <section id="overview" class="section">
                <h1>Frontend Integration Guide</h1>
                <p>This guide provides essential API documentation for frontend developers integrating with the Vaki OTT Platform. It focuses on the <strong>Content Service</strong> and <strong>User Service</strong> routes that are most commonly used by frontend applications.</p>
                
                <div class="info-box">
                    <strong>Note:</strong> This documentation covers only the essential endpoints for frontend integration. For complete API documentation, see the main documentation.
                </div>
            </section>

            <!-- Base URL -->
            <section id="base-url" class="section">
                <h2>Base URL</h2>
                <p>All API endpoints are accessible through the unified development server:</p>
                <pre><code class="language-bash">Base URL: https://api.vaki-ott.com</code></pre>
                <div class="info-box">
                    <strong>Route Prefixes:</strong>
                    <ul>
                        <li><strong>User Service:</strong> Routes are mounted directly (e.g., <code>/api/auth</code>, <code>/api/otp</code>, <code>/api/users</code>)</li>
                        <li><strong>Payment Service:</strong> Routes are prefixed with <code>/api/payments</code> (e.g., <code>/api/payments/create</code>, <code>/api/payments/rentals/active</code>)</li>
                        <li><strong>Content Service:</strong> Routes are prefixed with <code>/api/content/</code> (e.g., <code>/api/content/movies</code>, <code>/api/content/reels</code>, <code>/api/content/sections</code>)</li>
                        <li><strong>Admin Service:</strong> Routes are prefixed with <code>/api/admin/</code> (e.g., <code>/api/admin/movies</code>)</li>
                    </ul>
                </div>
            </section>

            <!-- Authentication -->
            <section id="authentication" class="section">
                <h2>Authentication</h2>
                <p>The API uses JWT (JSON Web Tokens) for authentication. There are two types of tokens:</p>
                
                <h3>Consumer JWT</h3>
                <p>Used for user-facing endpoints. Obtained through OTP login (see <a href="#auth-api">Authentication API</a>).</p>
                <p>Include in requests as:</p>
                <pre><code class="language-javascript">Authorization: Bearer &lt;token&gt;</code></pre>

                <h3>Token Refresh</h3>
                <p>Access tokens expire after a set period. Use the refresh token to obtain a new access token without requiring the user to log in again.</p>
            </section>

            <!-- User Service: OTP API -->
            <section id="otp-api" class="section">
                <h2>OTP API</h2>
                <p>Request and verify OTP (One-Time Password) for user authentication via email or SMS.</p>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/otp/email</span>
                    </div>
                    <div class="info-box" style="margin-top: 0.5rem; margin-bottom: 1rem;">
                        <strong>Note:</strong> User Service routes (OTP, Auth, Users) are mounted directly without service prefix.
                    </div>
                    <div class="endpoint-description">Request an OTP via email</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "email": "user@example.com",
  "purpose": "login" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "OTP sent to email"
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/otp/sms</span>
                    </div>
                    <div class="endpoint-description">Request an OTP via SMS</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "phoneNumber": "+1234567890",
  "purpose": "login" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "OTP sent to phone number"
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/otp/verify</span>
                    </div>
                    <div class="endpoint-description">Verify OTP code</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "identifier": "user@example.com", // email or phone
  "code": "123456",
  "purpose": "login" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "OTP verified successfully",
  "data": {
    "verified": true
  }
}</code></pre>
                </div>
            </section>

            <!-- User Service: Auth API -->
            <section id="auth-api" class="section">
                <h2>Authentication API</h2>
                <p>Handle user login, token refresh, logout, and session management.</p>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/auth/login</span>
                    </div>
                    <div class="endpoint-description">Login with OTP (Email or SMS)</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "identifier": "user@example.com",
  "code": "123456",
  "deviceName": "Chrome Browser", 
  "deviceType": "web", //web, mobile, tv
  "deviceId": "device-uuid", 
  "profileId": "profile-uuid" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Login successful",
  "data": {
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIs...",
      "refreshToken": "eyJhbGciOiJIUzI1NiIs...",
      "expiresIn": 3600
    },
    "user": {
      "id": "user-uuid",
      "email": "user@example.com",
      "phoneNumber": "+1234567890",
      "status": "active"
    },
    "profile": {
      "id": "profile-uuid",
      "name": "John's Profile",
      "isKidsProfile": false
    },
    "profiles": [
      {
        "id": "profile-uuid",
        "name": "John's Profile",
        "isKidsProfile": false
      }
    ],
    "sessionId": "session-uuid"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/auth/register-and-login</span>
                    </div>
                    <div class="endpoint-description">Unified authentication: Register and Login (or Register + Login if new user). This is the Netflix/Disney+ style passwordless authentication.</div>
                    <div class="info-box" style="margin-top: 0.5rem; margin-bottom: 1rem;">
                        <strong>Note:</strong> This endpoint combines OTP verification and login into a single step. If the user exists, it logs them in. If the user doesn't exist, it creates a new account and logs them in automatically.
                    </div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "identifier": "user@example.com", // email or phone number
  "code": "123456", // OTP code
  "deviceName": "iPhone 15 Pro", 
  "deviceType": "mobile", // 'mobile' | 'tv' | 'web' | etc.
  "deviceId": "device-uuid", //: unique device identifier
  "phoneNumberExtension": "+91", //  e.g., "+91" (for new phone users)
  "profile": { // for new users
    "name": "John's Profile",
    "country": "US"
  }
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Login successful",
  "data": {
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIs...",
      "refreshToken": "eyJhbGciOiJIUzI1NiIs...",
      "expiresIn": 3600
    },
    "user": {
      "id": "user-uuid",
      "email": "user@example.com",
      "phoneNumber": "+1234567890",
      "status": "active"
    },
    "profile": {
      "id": "profile-uuid",
      "name": "John's Profile",
      "isKidsProfile": false
    },
    "profiles": [
      {
        "id": "profile-uuid",
        "name": "John's Profile",
        "isKidsProfile": false
      }
    ],
    "sessionId": "session-uuid"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/auth/refresh</span>
                    </div>
                    <div class="endpoint-description">Refresh access token</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "refreshToken": "eyJhbGciOiJIUzI1NiIs...",
  "profileId": "profile-uuid" // optional
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIs...",
      "refreshToken": "eyJhbGciOiJIUzI1NiIs...",
      "expiresIn": 3600
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/auth/logout</span>
                    </div>
                    <div class="endpoint-description">Logout and revoke session</div>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "refreshToken": "eyJhbGciOiJIUzI1NiIs..." // optional if using Authorization header
}</code></pre>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span> (optional)</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Logout successful"
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/auth/me</span>
                    </div>
                    <div class="endpoint-description">Get current authenticated user</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "user-uuid",
    "email": "user@example.com",
    "phoneNumber": "+1234567890",
    "status": "active",
    "profiles": [
      {
        "id": "profile-uuid",
        "name": "John's Profile",
        "isKidsProfile": false,
        "maxContentRating": "PG-13",
        "profilePictureUrl": "https://cdn.example.com/avatars/profile-uuid.jpg",
        "country": "US"
      }
    ]
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/auth/sessions</span>
                    </div>
                    <div class="endpoint-description">Get all active sessions/devices for current user</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "session-uuid",
      "deviceName": "Chrome Browser",
      "deviceType": "web",
      "deviceId": "device-uuid",
      "ipAddress": "192.168.1.1",
      "lastActivityAt": "2025-01-15T10:30:00.000Z",
      "isActive": true,
      "expiresAt": "2025-02-15T10:30:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-delete">DELETE</span>
                        <span class="endpoint-path">/api/auth/sessions/:sessionId</span>
                    </div>
                    <div class="endpoint-description">Revoke a specific session/device</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Session revoked successfully"
}</code></pre>
                </div>
            </section>

            <!-- User Service: Users API -->
            <section id="users-api" class="section">
                <h2>Users & Profiles API</h2>
                <p>Manage user account settings and OTT profiles.</p>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/users/countries</span>
                    </div>
                    <div class="endpoint-description">List supported countries (for phone codes and profile country selection)</div>
                    <p><strong>Access:</strong> Public (no authentication required)</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    { "code": "AR", "name": "Argentina", "phoneCode": "+54" },
    { "code": "AU", "name": "Australia", "phoneCode": "+61" },
    { "code": "IN", "name": "India", "phoneCode": "+91" },
    { "code": "US", "name": "United States", "phoneCode": "+1" },
    { "code": "VN", "name": "Vietnam", "phoneCode": "+84" }
  ]
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Returns the full country list with ISO code, display name, and phone code. Use this to populate country/phone code pickers before OTP or profile creation.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/users/me</span>
                    </div>
                    <div class="endpoint-description">Get current user account info and profiles</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "user-uuid",
    "email": "user@example.com",
    "phoneNumber": "+1234567890",
    "phoneNumberExtension": "+1",
    "status": "active",
    "lastLogin": "2025-01-15T10:30:00.000Z",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T10:30:00.000Z",
    "profiles": [
      {
        "id": "profile-uuid",
        "name": "John's Profile",
        "isKidsProfile": false,
        "maxContentRating": "PG-13",
        "profilePictureUrl": "https://cdn.example.com/avatars/profile-uuid.jpg",
        "country": "US",
        "createdAt": "2025-01-01T00:00:00.000Z",
        "updatedAt": "2025-01-15T10:30:00.000Z"
      }
    ]
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-patch">PATCH</span>
                        <span class="endpoint-path">/api/users/me/settings</span>
                    </div>
                    <div class="endpoint-description">Update account settings (email, phone, extension)</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "email": "newemail@example.com", // optional
  "phoneNumber": "+1234567890", // optional
  "phoneNumberExtension": "+1" // optional
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Account settings updated successfully",
  "data": {
    "id": "user-uuid",
    "email": "newemail@example.com",
    "phoneNumber": "+1234567890",
    "phoneNumberExtension": "+1"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/users/me/profiles</span>
                    </div>
                    <div class="endpoint-description">List all OTT profiles for current user</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "profile-uuid",
      "name": "John's Profile",
      "isKidsProfile": false,
      "maxContentRating": "PG-13",
      "profilePictureUrl": "https://cdn.example.com/avatars/profile-uuid.jpg",
      "country": "US",
      "createdAt": "2025-01-01T00:00:00.000Z",
      "updatedAt": "2025-01-15T10:30:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/users/me/profiles</span>
                    </div>
                    <div class="endpoint-description">Create a new OTT profile</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "name": "John's Profile",
  "isKidsProfile": false, 
  "maxContentRating": "PG-13", 
  "country": "US" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Profile created successfully",
  "data": {
    "id": "profile-uuid",
    "name": "John's Profile",
    "isKidsProfile": false,
    "maxContentRating": "PG-13",
    "profilePictureUrl": null,
    "country": "US",
    "createdAt": "2025-01-15T10:30:00.000Z",
    "updatedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-patch">PATCH</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId</span>
                    </div>
                    <div class="endpoint-description">Update an OTT profile</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "name": "Updated Profile Name", // optional
  "isKidsProfile": false, // optional
  "maxContentRating": "PG-13", // optional
  "country": "US" // optional
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Profile updated successfully",
  "data": {
    "id": "profile-uuid",
    "name": "Updated Profile Name",
    "isKidsProfile": false,
    "maxContentRating": "PG-13",
    "profilePictureUrl": "https://cdn.example.com/avatars/profile-uuid.jpg",
    "country": "US",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-delete">DELETE</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId</span>
                    </div>
                    <div class="endpoint-description">Delete an OTT profile</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Profile deleted successfully"
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId/avatar</span>
                    </div>
                    <div class="endpoint-description">Upload profile avatar</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <p><strong>Content-Type:</strong> <span class="inline-code">multipart/form-data</span></p>
                    <p><strong>Form Data:</strong> <span class="inline-code">avatar</span> (file)</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Avatar uploaded successfully",
  "data": {
    "id": "profile-uuid",
    "profilePictureUrl": "https://cdn.example.com/avatars/profile-uuid.jpg"
  }
}</code></pre>
                </div>

                <h3>Watch Later</h3>
                <div class="info-box" style="margin-bottom: 1.5rem;">
                    <strong>How Watch Later Works for Movies, Series, and Episodes:</strong>
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li><strong>Movies, Short Films, Documentaries, BTS, Reels:</strong> Use <code>contentType: "movie"</code> (or <code>"short_film"</code>, <code>"documentary"</code>, <code>"bts"</code>, <code>"reel"</code>) and provide the <code>contentId</code> (movie ID).</li>
                        <li><strong>Series:</strong> Use <code>contentType: "series"</code> and provide the <code>seriesId</code>. This adds the entire series to watch later.</li>
                        <li><strong>Episodes:</strong> Use <code>contentType: "episode"</code> and provide the <code>episodeId</code>. This adds a specific episode to watch later.</li>
                        <li><strong>Content Types:</strong> The API supports the following content types:
                            <ul style="margin-top: 0.25rem; margin-left: 1.5rem;">
                                <li><code>"movie"</code> - Standalone movies</li>
                                <li><code>"short_film"</code> - Short films</li>
                                <li><code>"documentary"</code> - Documentaries</li>
                                <li><code>"bts"</code> - Behind the scenes content</li>
                                <li><code>"reel"</code> - Reels</li>
                                <li><code>"series"</code> - TV series/shows</li>
                                <li><code>"episode"</code> - Individual series episodes</li>
                            </ul>
                        </li>
                        <li><strong>Note:</strong> The watch later system now supports all content types with dedicated fields. The response includes the <code>contentType</code> field to help you differentiate content types in your frontend.</li>
                    </ul>
                </div>
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId/watch-later</span>
                    </div>
                    <div class="endpoint-description">List watch later items for a profile</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>page</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Page number (default: 1)</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Items per page (default: 20, max: 100)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "data": [
      {
        "contentType": "movie",
        "contentId": "movie-uuid",
        "addedAt": "2025-01-15T10:30:00.000Z",
        "content": {
          "id": "movie-uuid",
          "title": "Movie Title",
          "slug": "movie-title",
          "description": "Movie description",
          "shortDescription": "Short description",
          "year": 2024,
          "duration": 120,
          "releaseDate": "2024-01-15",
          "isReleased": true,
          "contentType": "free",
          "status": "published",
          "mediaType": "movie",
          "language": {
            "id": "language-uuid",
            "name": "English",
            "code": "en"
          },
          "rating": {
            "id": "rating-uuid",
            "name": "PG-13",
            "slug": "pg-13"
          },
          "posterUrl": "https://cdn.example.com/posters/movie-uuid.jpg"
        }
      },
      {
        "contentType": "series",
        "seriesId": "series-uuid",
        "addedAt": "2025-01-14T15:20:00.000Z",
        "content": {
          "id": "series-uuid",
          "title": "Series Title",
          "slug": "series-title",
          "description": "Series description",
          "shortDescription": "Short description",
          "year": 2024,
          "releaseDate": "2024-01-10",
          "isReleased": true,
          "contentType": "free",
          "status": "published",
          "language": {
            "id": "language-uuid",
            "name": "English",
            "code": "en"
          },
          "rating": {
            "id": "rating-uuid",
            "name": "PG-13",
            "slug": "pg-13"
          },
          "posterUrl": "https://cdn.example.com/posters/series-uuid.jpg"
        }
      },
      {
        "contentType": "episode",
        "episodeId": "episode-uuid",
        "addedAt": "2025-01-13T12:10:00.000Z",
        "content": {
          "id": "episode-uuid",
          "title": "Episode Title",
          "description": "Episode description",
          "shortDescription": "Short description",
          "year": 2024,
          "releaseDate": "2024-01-08",
          "isReleased": true,
          "contentType": "free",
          "status": "published",
          "episodeNumber": 1,
          "seasonNumber": 1,
          "seriesTitle": "Series Title",
          "seriesId": "series-uuid",
          "posterUrl": "https://cdn.example.com/posters/series-uuid.jpg"
        }
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Content Type Identification:</strong> Each watch later item includes a <code>contentType</code> field that clearly identifies the type of content:
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li><code>"movie"</code>, <code>"short_film"</code>, <code>"documentary"</code>, <code>"bts"</code>, <code>"reel"</code> - Use <code>contentId</code> field</li>
                            <li><code>"series"</code> - Use <code>seriesId</code> field</li>
                            <li><code>"episode"</code> - Use <code>episodeId</code> field, includes <code>episodeNumber</code>, <code>seasonNumber</code>, and <code>seriesTitle</code> in the content object</li>
                        </ul>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId/watch-later</span>
                    </div>
                    <div class="endpoint-description">Add content to watch later</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <p>For movies, short films, documentaries, BTS, or reels:</p>
                    <pre><code class="language-json">{
  "contentType": "movie",
  "contentId": "movie-uuid"
}</code></pre>
                    <p>For series:</p>
                    <pre><code class="language-json">{
  "contentType": "series",
  "seriesId": "series-uuid"
}</code></pre>
                    <p>For episodes:</p>
                    <pre><code class="language-json">{
  "contentType": "episode",
  "episodeId": "episode-uuid"
}</code></pre>
                    <h4>Response:</h4>
                    <p>For movies/short films/documentaries/BTS/reels:</p>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "contentType": "movie",
    "contentId": "movie-uuid",
    "addedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                    <p>For series:</p>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "contentType": "series",
    "seriesId": "series-uuid",
    "addedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                    <p>For episodes:</p>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "contentType": "episode",
    "episodeId": "episode-uuid",
    "addedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId/watch-later/check</span>
                    </div>
                    <div class="endpoint-description">Check if content is in watch later</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>contentType</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Content type: <code>movie</code>, <code>short_film</code>, <code>documentary</code>, <code>bts</code>, <code>reel</code>, <code>series</code>, or <code>episode</code></td>
                            </tr>
                            <tr>
                                <td><code>contentId</code></td>
                                <td>string</td>
                                <td>Conditional</td>
                                <td>Required for movies/short films/documentaries/BTS/reels</td>
                            </tr>
                            <tr>
                                <td><code>seriesId</code></td>
                                <td>string</td>
                                <td>Conditional</td>
                                <td>Required for series</td>
                            </tr>
                            <tr>
                                <td><code>episodeId</code></td>
                                <td>string</td>
                                <td>Conditional</td>
                                <td>Required for episodes</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/users/me/profiles/:profileId/watch-later/check?contentType=movie&contentId=movie-uuid
GET /api/users/me/profiles/:profileId/watch-later/check?contentType=series&seriesId=series-uuid
GET /api/users/me/profiles/:profileId/watch-later/check?contentType=episode&episodeId=episode-uuid</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "isInWatchLater": true,
    "addedAt": "2025-01-15T10:30:00.000Z"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-delete">DELETE</span>
                        <span class="endpoint-path">/api/users/me/profiles/:profileId/watch-later</span>
                    </div>
                    <div class="endpoint-description">Remove content from watch later</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <p>For movies, short films, documentaries, BTS, or reels:</p>
                    <pre><code class="language-json">{
  "contentType": "movie",
  "contentId": "movie-uuid"
}</code></pre>
                    <p>For series:</p>
                    <pre><code class="language-json">{
  "contentType": "series",
  "seriesId": "series-uuid"
}</code></pre>
                    <p>For episodes:</p>
                    <pre><code class="language-json">{
  "contentType": "episode",
  "episodeId": "episode-uuid"
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "removed": "movie-uuid"
  }
}</code></pre>
                </div>
            </section>

            <!-- Payment Service: Payments & Rentals API -->
            <section id="payments-api" class="section">
                <h2>Payments & Rentals API</h2>
                <p>Handle payment processing for content rentals (movies, series, episodes). Supports RazorPay and Apple Pay gateways.</p>
                <div class="info-box" style="margin-bottom: 1.5rem;">
                    <strong>Route Prefix:</strong> All Payment Service routes are prefixed with <code>/api/payments</code>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/pricing/:contentType/:contentId</span>
                    </div>
                    <div class="endpoint-description">Get available rental pricing tiers for content (movie, series, or episode)</div>
                    <p><strong>Access:</strong> Public (no authentication required)</p>
                    <h4>Path Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>contentType</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Content type: <code>movie</code>, <code>series</code>, or <code>episode</code></td>
                            </tr>
                            <tr>
                                <td><code>contentId</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>UUID of the content (movie, series, or episode)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/payments/pricing/movie/c6bd0765-306d-43be-ade3-51e35389d207
GET /api/payments/pricing/series/series-uuid
GET /api/payments/pricing/episode/episode-uuid</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "pricing": [
      {
        "durationHours": 24,
        "price": 149,
        "currency": "INR"
      },
      {
        "durationHours": 36,
        "price": 199,
        "currency": "INR"
      },
      {
        "durationHours": 72,
        "price": 299,
        "currency": "INR"
      },
      {
        "durationHours": 96,
        "price": 399,
        "currency": "INR"
      },
      {
        "durationHours": 168,
        "price": 499,
        "currency": "INR"
      }
    ]
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Returns all available rental price tiers for the specified content, sorted by duration (shortest to longest). Prices are in paisa (INR * 100) or cents (USD * 100). Only tiers that are configured for the content are returned. Use this endpoint to display pricing options to users before creating a payment.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/config</span>
                    </div>
                    <div class="endpoint-description">Get payment gateway configuration</div>
                    <p><strong>Access:</strong> Public (no authentication required)</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "razorpay": {
      "configured": true,
      "keyId": "rzp_test_xxxxx"
    },
    "supportedGateways": ["razorpay", "apple_pay"],
    "currency": "INR"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/payments/create</span>
                    </div>
                    <div class="endpoint-description">Create a payment order for renting content</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "contentId": "movie-uuid",
  "contentType": "movie", // "movie" | "series" | "episode"
  "durationHours": 24, //  24, 36, 72, 96, or 168 (defaults to 24)
  "platform": "web" // optional: "ios" | "android" | "web"
}</code></pre>
                    <h4>Request Body Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>contentId</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>UUID of the content to rent</td>
                            </tr>
                            <tr>
                                <td><code>contentType</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Content type: <code>movie</code>, <code>series</code>, or <code>episode</code></td>
                            </tr>
                            <tr>
                                <td><code>durationHours</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Rental duration in hours. Must be one of: <code>24</code>, <code>36</code>, <code>72</code>, <code>96</code>, <code>168</code>. Defaults to <code>24</code> if not specified.</td>
                            </tr>
                            <tr>
                                <td><code>platform</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Platform: <code>web</code>, <code>ios</code>, or <code>android</code>. Used for gateway selection (Apple Pay for iOS users from USA).</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "paymentId": "payment-uuid",
    "amount": 5000, // in paisa (INR) or cents (USD)
    "currency": "INR", // or "USD" for Apple Pay
    "gateway": "razorpay", // or "apple_pay"
    "gatewayOrderId": "order_xxxxx", // RazorPay order ID (null for Apple Pay)
    "paymentData": {
      "orderId": "order_xxxxx",
      "amount": 5000,
      "currency": "INR",
      "keyId": "rzp_test_xxxxx"
    },
    "content": {
      "id": "movie-uuid",
      "title": "Movie Title",
      "type": "movie"
    },
    "durationHours": 48
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Payment Gateway Selection:</strong>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li><strong>RazorPay:</strong> Used by default for all users (INR currency)</li>
                            <li><strong>Apple Pay:</strong> Automatically selected for iOS users from USA (USD currency)</li>
                            <li>For Apple Pay, <code>paymentData.requiresClientSidePayment</code> will be <code>true</code> - you'll need to handle the payment on the client side</li>
                        </ul>
                        <p style="margin-top: 0.5rem;"><strong>Note:</strong> RazorPay receipt format is <code>r_&lt;payment-id&gt;</code> (max 40 characters as per RazorPay requirements).</p>
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/payments/verify</span>
                    </div>
                    <div class="endpoint-description">Verify and complete payment (frontend callback after payment gateway success)</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <p>For RazorPay:</p>
                    <pre><code class="language-json">{
  "paymentId": "payment-uuid",
  "gatewayOrderId": "order_xxxxx",
  "gatewayPaymentId": "pay_xxxxx",
  "gatewaySignature": "signature_xxxxx"
}</code></pre>
                    <p>For Apple Pay:</p>
                    <pre><code class="language-json">{
  "paymentId": "payment-uuid",
  "gatewayPaymentId": "transaction_id_xxxxx"
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "payment": {
      "id": "payment-uuid",
      "userId": "user-uuid",
      "amount": 5000,
      "currency": "INR",
      "gateway": "razorpay",
      "status": "completed",
      "paidAt": "2025-01-15T10:30:00.000Z"
    },
    "rental": {
      "id": "rental-uuid",
      "paymentId": "payment-uuid",
      "userId": "user-uuid",
      "contentType": "movie",
      "movieId": "movie-uuid",
      "rentedAt": "2025-01-15T10:30:00.000Z",
      "expiresAt": "2025-01-17T10:30:00.000Z",
      "durationHours": 48
    },
    "message": "Payment verified and rental activated"
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Note:</strong> This endpoint is idempotent. If the payment is already verified, it returns the existing rental without creating a duplicate.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/rental-status/:contentId</span>
                    </div>
                    <div class="endpoint-description">Get rental status for specific content</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>type</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Content type: <code>movie</code>, <code>series</code>, or <code>episode</code> (default: <code>movie</code>)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/payments/rental-status/movie-uuid?type=movie
GET /api/payments/rental-status/series-uuid?type=series
GET /api/payments/rental-status/episode-uuid?type=episode</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "contentId": "movie-uuid",
    "mediaType": "movie",
    "contentType": "rent", // "free" | "rent" | "subscription"
    "hasActiveRental": true,
    "rental": {
      "id": "rental-uuid",
      "rentedAt": "2025-01-15T10:30:00.000Z",
      "expiresAt": "2025-01-17T10:30:00.000Z",
      "isExpired": false,
      "timeRemaining": 172800 // seconds remaining
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/rentals/active</span>
                    </div>
                    <div class="endpoint-description">Get user's active rentals</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "rentals": [
      {
        "id": "rental-uuid",
        "paymentId": "payment-uuid",
        "userId": "user-uuid",
        "contentType": "movie",
        "movieId": "movie-uuid",
        "movie": {
          "id": "movie-uuid",
          "title": "Movie Title",
          "slug": "movie-title"
        },
        "rentedAt": "2025-01-15T10:30:00.000Z",
        "expiresAt": "2025-01-17T10:30:00.000Z",
        "durationHours": 48,
        "isExpired": false,
        "timeRemaining": 172800
      },
      {
        "id": "rental-uuid-2",
        "contentType": "series",
        "seriesId": "series-uuid",
        "series": {
          "id": "series-uuid",
          "title": "Series Title",
          "slug": "series-title"
        },
        "rentedAt": "2025-01-14T08:00:00.000Z",
        "expiresAt": "2025-01-16T08:00:00.000Z",
        "isExpired": false
      }
    ],
    "count": 2
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/history</span>
                    </div>
                    <div class="endpoint-description">Get user's payment history</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>page</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Page number (default: 1)</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Items per page (default: 20, max: 100)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "payments": [
      {
        "id": "payment-uuid",
        "userId": "user-uuid",
        "amount": 5000,
        "currency": "INR",
        "gateway": "razorpay",
        "status": "completed",
        "contentType": "movie",
        "movieId": "movie-uuid",
        "movie": {
          "id": "movie-uuid",
          "title": "Movie Title",
          "slug": "movie-title"
        },
        "createdAt": "2025-01-15T10:30:00.000Z",
        "paidAt": "2025-01-15T10:30:05.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/payments/:paymentId</span>
                    </div>
                    <div class="endpoint-description">Get payment status and details</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "payment": {
      "id": "payment-uuid",
      "userId": "user-uuid",
      "amount": 5000,
      "currency": "INR",
      "gateway": "razorpay",
      "gatewayOrderId": "order_xxxxx",
      "gatewayPaymentId": "pay_xxxxx",
      "status": "completed", // "pending" | "completed" | "failed"
      "contentType": "movie",
      "movieId": "movie-uuid",
      "createdAt": "2025-01-15T10:30:00.000Z",
      "paidAt": "2025-01-15T10:30:05.000Z"
    },
    "rental": {
      "id": "rental-uuid",
      "paymentId": "payment-uuid",
      "expiresAt": "2025-01-17T10:30:00.000Z"
    }
  }
}</code></pre>
                </div>

                <div class="info-box warning" style="margin-top: 2rem;">
                    <strong>Payment Flow:</strong>
                    <ol style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Call <code>POST /api/payments/create</code> to create a payment order</li>
                        <li>Use the returned <code>paymentData</code> to initiate payment with the gateway (RazorPay or Apple Pay)</li>
                        <li>After successful payment on the gateway, call <code>POST /api/payments/verify</code> with the payment details</li>
                        <li>The verify endpoint creates a rental record and grants access to the content</li>
                        <li>Use <code>GET /api/payments/rental-status/:contentId</code> to check if content is accessible</li>
                    </ol>
                </div>

                <div class="info-box" style="margin-top: 1rem;">
                    <strong>Rental Duration:</strong> Rentals typically last 48 hours (configurable per content). There's a grace period after expiration during which access may still be granted. Use the <code>rental-status</code> endpoint to check current access status.
                </div>
            </section>

            <!-- Content Service: Movies API -->
            <section id="movies-api" class="section">
                <h2>Movies API</h2>
                <p>Public catalog endpoints for browsing and viewing movie content. No authentication required.</p>
                <div class="info-box" style="margin-bottom: 1.5rem;">
                    <strong>Route Prefix:</strong> All Content Service routes are prefixed with <code>/api/content/</code>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/movies</span>
                    </div>
                    <div class="endpoint-description">Get paginated list of movies with filters</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>page</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Page number (default: 1)</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Items per page (default: 20, max: 100)</td>
                            </tr>
                            <tr>
                                <td><code>status</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Filter by status: <code>draft</code>, <code>published</code>, <code>archived</code></td>
                            </tr>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Search movies by title or description</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/movies?page=1&limit=12&status=published</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "data": [
      {
        "id": "movie-uuid",
        "title": "Movie Title",
        "status": "published",
          "year": 2024,
          "duration": 120,
          "language": "English",
          "rating": "PG-13",
          "genres": ["Action", "Thriller"],
          "posterUrl": "https://cdn.example.com/posters/movie-uuid.jpg",
          "backdropUrl": "https://cdn.example.com/backdrops/movie-uuid.jpg",
          "createdAt": "2025-01-01T00:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 12,
      "total": 100,
      "totalPages": 9
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/movies/:id</span>
                    </div>
                    <div class="endpoint-description">Get detailed movie information by ID with recommendations</div>
                    
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/movies/abc123</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "movie-uuid",
    "title": "Movie Title",
    "slug": "movie-title",
    "description": "Movie description",
    "shortDescription": "Short description",
    "year": 2025,
    "duration": 116,
    "releaseDate": "2025-11-12",
    "contentType": "rent",
    "rentalPrice24h": 149,
    "rentalPrice36h": 199,
    "rentalPrice72h": null,
    "rentalPrice96h": null,
    "rentalPrice168h": null,
    "rentalAvailable": true,
    "status": "published",
    "language": {
      "id": "language-uuid",
      "name": "Mizo",
      "code": "lus"
    },
    "rating": {
      "id": "rating-uuid",
      "name": "PG-13",
      "description": "Some material may not be suitable for children...",
      "minAge": 13
    },
    "genres": [
      {
        "id": "genre-uuid",
        "name": "Action",
        "slug": "action"
      }
    ],
    "directors": [
      {
        "id": "director-uuid",
        "name": "Director Name",
        "slug": "director-name",
        "role": "director",
        "photo": "https://cdn.example.com/directors/director-uuid.jpg"
      }
    ],
    "cast": [
      {
        "id": "actor-uuid",
        "actorId": "actor-uuid",
        "actorName": "Actor Name",
        "character": "Character Name",
        "isLead": true,
        "photo": "https://cdn.example.com/actors/actor-uuid.jpg"
      }
    ],
    "producers": [
      {
        "id": "producer-uuid",
        "name": "Producer Name",
        "slug": "producer-name",
        "role": "producer",
        "productionCompany": "Production Company",
        "photo": "https://cdn.example.com/producers/producer-uuid.jpg"
      }
    ],
    "posterUrl": "https://cdn.example.com/posters/movie-uuid.jpg",
    "backdropUrl": "https://cdn.example.com/backdrops/movie-uuid.jpg",
    "media": {
      "posters": [
        {
          "id": "asset-uuid",
          "fileType": "poster",
          "fileCategory": "poster",
          "cdnUrl": "https://cdn.example.com/posters/movie-uuid.jpg",
          "width": 1200,
          "height": 1800,
          "imageResolution": "original",
          "isPrimary": true
        }
      ],
      "backdrops": [
        {
          "id": "asset-uuid",
          "fileType": "backdrop",
          "fileCategory": "backdrop",
          "cdnUrl": "https://cdn.example.com/backdrops/movie-uuid.jpg",
          "width": 1920,
          "height": 1080,
          "imageResolution": "original"
        }
      ],
      "titleImages": [],
      "videos": [],
      "trailers": []
    },
    "trailerVideo": {
      "id": "stream-video-uuid",
      "streamVideoId": "cloudflare-stream-id",
      "movieId": "movie-uuid",
      "videoType": "Trailer",
      "thumbnailUrl": "https://customer-xyz.cloudflarestream.com/.../thumbnails/thumbnail.jpg",
      "previewUrl": "https://customer-xyz.cloudflarestream.com/.../watch",
      "hlsUrl": "https://customer-xyz.cloudflarestream.com/.../manifest/video.m3u8",
      "dashUrl": "https://customer-xyz.cloudflarestream.com/.../manifest/video.mpd",
      "defaultQuality": "auto",
      "requiresAuth": true,
      "status": "ready"
    },
    "titleImageUrl": "https://cdn.example.com/title-images/movie-uuid.jpg",
    "recommendations": [
      {
        "id": "recommended-movie-uuid",
        "title": "Recommended Movie",
        "status": "published",
        "year": 2025,
        "duration": 120,
        "language": "Mizo",
        "rating": "PG-13",
        "genres": ["Action", "Thriller"],
        "posterUrl": "https://cdn.example.com/posters/recommended-movie-uuid.jpg",
        "backdropUrl": "https://cdn.example.com/backdrops/recommended-movie-uuid.jpg",
        "createdAt": "2025-01-01T00:00:00.000Z"
      }
    ],
    "createdAt": "2025-10-28T06:42:27.276Z",
    "updatedAt": "2025-11-28T10:11:56.188Z"
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> This endpoint includes movie recommendations based on shared genres, directors, and actors. Recommendations are ordered by relevance (more shared genres = higher priority). The response includes photos for directors, cast, and producers, as well as trailer video information if available. Media assets are grouped by type (posters, backdrops, titleImages, videos, trailers) and only essential fields are returned. Directors and producers include their roles. Use the pricing endpoint to get available rental price tiers.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/movies/:id/with-photos</span>
                    </div>
                    <div class="endpoint-description">Get movie details with all media assets</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "movie-uuid",
    "title": "Movie Title",
    "description": "Movie description",
    "year": 2024,
    "duration": 120,
    "language": { "id": "language-uuid", "name": "English" },
    "rating": { "id": "rating-uuid", "name": "PG-13" },
    "genres": [{"id": "genre-uuid", "name": "Action"}],
    "directors": [{"id": "director-uuid", "name": "Director Name"}],
    "cast": [{"actorName": "Actor Name", "characterName": "Character"}],
    "producers": [{"id": "producer-uuid", "name": "Producer Name"}],
    "media": [
      {
        "id": "asset-uuid",
        "fileType": "poster",
        "fileCategory": "poster",
        "cdnUrl": "https://cdn.example.com/posters/movie-uuid.jpg",
        "width": 1920,
        "height": 1080,
        "imageResolution": "original"
      }
    ]
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/movies/:id/video-status</span>
                    </div>
                    <div class="endpoint-description">Get video transcoding status and thumbnails</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "videos": [
      {
        "id": "asset-uuid",
        "fileType": "video",
        "fileCategory": "main",
        "cdnUrl": "https://cdn.example.com/videos/movie-uuid.mp4",
        "uploadStatus": "completed",
        "processingStatus": "completed",
        "width": 1920,
        "height": 1080,
        "duration": 7200
      }
    ],
    "thumbnails": [
      {
        "id": "thumbnail-uuid",
        "fileType": "photo",
        "fileCategory": "thumbnail",
        "cdnUrl": "https://cdn.example.com/thumbnails/movie-uuid.jpg"
      }
    ]
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/movies/:id/image-status</span>
                    </div>
                    <div class="endpoint-description">Get poster/backdrop status grouped by file category and resolution</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "posters": {
      "poster": [
        {
          "id": "asset-uuid",
          "fileType": "poster",
          "fileCategory": "poster",
          "cdnUrl": "https://cdn.example.com/posters/movie-uuid.jpg",
          "width": 1920,
          "height": 1080,
          "imageResolution": "original"
        }
      ]
    },
    "backdrops": {
      "backdrop": [
        {
          "id": "asset-uuid",
          "fileType": "backdrop",
          "fileCategory": "backdrop",
          "cdnUrl": "https://cdn.example.com/backdrops/movie-uuid.jpg",
          "width": 3840,
          "height": 2160,
          "imageResolution": "original"
        }
      ]
    }
  }
}</code></pre>
                </div>
            </section>

            <!-- Content Service: Reels API -->
            <section id="reels-api" class="section">
                <h2>Reels API</h2>
                <p>Public catalog endpoints for browsing and viewing reel content (short-form vertical videos). No authentication required.</p>
                <div class="info-box" style="margin-bottom: 1.5rem;">
                    <strong>Route Prefix:</strong> All Content Service routes are prefixed with <code>/api/content/</code>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/reels</span>
                    </div>
                    <div class="endpoint-description">Get paginated list of reels with filters</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>page</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Page number (default: 1)</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Items per page (default: 20, max: 100)</td>
                            </tr>
                            <tr>
                                <td><code>status</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Filter by status: <code>draft</code>, <code>published</code>, <code>archived</code></td>
                            </tr>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Search reels by title or description</td>
                            </tr>
                            <!-- <tr>
                                <td><code>contentType</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Filter by content type: <code>free</code>, <code>rent</code>, <code>subscription</code></td>
                            </tr> -->
                            <tr>
                                <td><code>minYear</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Filter by minimum release year</td>
                            </tr>
                            <tr>
                                <td><code>maxYear</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Filter by maximum release year</td>
                            </tr>
                            <tr>
                                <td><code>languageId</code></td>
                                <td>string (UUID)</td>
                                <td>No</td>
                                <td>Filter by language ID</td>
                            </tr>
                            <tr>
                                <td><code>contentRatingId</code></td>
                                <td>string (UUID)</td>
                                <td>No</td>
                                <td>Filter by content rating ID</td>
                            </tr>
                            <tr>
                                <td><code>sortField</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Sort field: <code>createdAt</code>, <code>title</code>, <code>year</code>, etc.</td>
                            </tr>
                            <tr>
                                <td><code>sortDirection</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Sort direction: <code>asc</code> or <code>desc</code> (default: <code>desc</code>)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/reels?page=1&limit=12&status=published</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "data": [
      {
        "id": "reel-uuid",
        "title": "Reel Title",
        "status": "published",
        "year": 2024,
        "duration": 60,
        "language": "English",
        "rating": "PG-13",
        "thumbnailUrl": "https://videodelivery.net/.../thumbnails/thumbnail.jpg",
        "playbackUrl": "https://videodelivery.net/.../manifest/video.m3u8",
        "createdAt": "2025-01-01T00:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 12,
      "total": 50,
      "totalPages": 5
    }
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Reels are short-form vertical videos optimized for mobile viewing. The response includes <code>thumbnailUrl</code> and <code>playbackUrl</code> from the associated stream video for easy playback integration.
                    </div>
                </div>
            </section>

            <!-- Content Service: Sections API -->
            <section id="sections-api" class="section">
                <h2>Sections API</h2>
                <p>Get sections with populated movie data for different contexts and platforms. Supports multiple contexts: home, movies, short films, documentaries, bts, search, and profile.</p>

                <div class="info-box warning">
                    <strong>Deprecated:</strong> The <code>/api/content/home</code> endpoint is deprecated. Use <code>/api/content/sections?context=home&platform=...</code> instead. The old endpoint still works for backward compatibility but redirects to the new endpoint.
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/sections</span>
                    </div>
                    <div class="endpoint-description">Get active sections for a context and platform</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>context</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Section context: <code>home</code>, <code>movies</code>, <code>short_films</code> (or <code>short-films</code>), <code>documentaries</code>, <code>bts</code>, <code>search</code>, or <code>profile</code></td>
                            </tr>
                            <tr>
                                <td><code>platform</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Platform filter: <code>web</code>, <code>mobile</code>, or <code>tv</code></td>
                            </tr>
                            <tr>
                                <td><code>maxContentRating</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Filter movies by maximum content rating. Provide a content rating ID or name. Only movies with content rating minAge &lt;= maxContentRating minAge (or IS NULL) will be returned. If not provided, all movies are returned.</td>
                            </tr>
                            <tr>
                                <td><code>showInactive</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Include inactive sections. Set to <code>true</code> to include sections where <code>isActive = false</code>. Default: <code>false</code> (only active sections)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Examples:</h4>
                    <pre><code class="language-bash"># Get home sections for web platform
GET /api/content/sections?context=home&platform=web

# Get movies sections for mobile platform with maxContentRating filter (by ID)
GET /api/content/sections?context=movies&platform=mobile&maxContentRating=rating-uuid-123

# Get movies sections with maxContentRating filter (by name, e.g., "PG-13")
GET /api/content/sections?context=movies&platform=mobile&maxContentRating=PG-13

# Get all sections including inactive ones
GET /api/content/sections?context=home&platform=tv&showInactive=true</code></pre>
                    <h4>Response Structure:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "section-123",
      "slug": "trending",
      "title": "Trending Now",
      "description": "Popular movies this week",
      "platform": "web",
      "context": "home",
      "sectionType": "carousel",
      "displayOrder": 0,
      "priority": 0,
      "isActive": true,
      "showViewAll": true,
      "styleConfig": {
        "background": "dark",
        "showArrows": true,
        "showDots": false,
        "titleImageTransition": {
          "type": "fade-slide-up",
          "duration": 700,
          "easing": "ease-out",
          "delay": 200,
          "distance": 30
        }
      },
      "dataSourceType": "query", // or "manual"
      "movies": [
        {
          "id": "movie-456",
          "title": "Movie Title",
          "slug": "movie-title",
          "description": "Movie description",
          "year": 2024,
          "duration": 120,
          "language": "English",
          "rating": "PG-13",
          "genres": ["Action", "Thriller"],
          "posterUrl": "https://cdn.example.com/posters/movie-456.jpg",
          "backdropUrl": "https://cdn.example.com/backdrops/movie-456.jpg",
          "titleImageUrl": "https://cdn.example.com/title-images/movie-456.jpg",
          "heroUrl": "https://cdn.example.com/hero/movie-456.jpg",
          "posterCleanUrl": "https://cdn.example.com/posters-clean/movie-456.jpg",
          "backdropCleanUrl": "https://cdn.example.com/backdrops-clean/movie-456.jpg"
        }
      ],
      "queryConfig": {
        "filters": {
          "genreSlugs": ["action"],
          "minYear": 2020,
          "status": "published"
        },
        "sort": {
          "field": "releaseDate",
          "direction": "desc"
        },
        "limit": 20
      }
    }
  ]
}</code></pre>
                    <h4>Section Type Values:</h4>
                    <p>The <code>sectionType</code> field indicates how the section should be displayed:</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Value</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>carousel</code></td>
                                <td>Horizontal scrolling carousel of movies</td>
                            </tr>
                            <tr>
                                <td><code>carousel-album</code></td>
                                <td>Album-style carousel with larger movie cards</td>
                            </tr>
                            <tr>
                                <td><code>carousel-banner</code></td>
                                <td>Banner-style carousel with featured content</td>
                            </tr>
                            <tr>
                                <td><code>hero</code></td>
                                <td>Hero section typically used for featured content at the top</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Context Values:</h4>
                    <p>The <code>context</code> parameter determines which sections to retrieve:</p>
                    <table>
                        <thead>
                            <tr>
                                <th>Value</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>home</code></td>
                                <td>Home page sections</td>
                            </tr>
                            <tr>
                                <td><code>movies</code></td>
                                <td>Movies page sections</td>
                            </tr>
                            <tr>
                                <td><code>short_films</code> or <code>short-films</code></td>
                                <td>Short films page sections (both formats accepted)</td>
                            </tr>
                            <tr>
                                <td><code>documentaries</code></td>
                                <td>Documentaries page sections</td>
                            </tr>
                            <tr>
                                <td><code>bts</code></td>
                                <td>Behind the scenes sections</td>
                            </tr>
                            <tr>
                                <td><code>search</code></td>
                                <td>Search page sections</td>
                            </tr>
                            <tr>
                                <td><code>profile</code></td>
                                <td>Profile page sections</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="info-box">
                        <strong>Notes:</strong>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li>Returns only active sections that respect <code>startDate</code> and <code>endDate</code> scheduling (unless <code>showInactive=true</code>)</li>
                            <li>Sections are sorted by <code>displayOrder</code> (ascending), then <code>priority</code> (descending)</li>
                            <li>Sections with <code>platform=web</code> are shown on all platforms</li>
                            <li>When <code>maxContentRating</code> is provided, movies are filtered by content rating. Only movies where the content rating's <code>minAge</code> is &lt;= the maxContentRating's <code>minAge</code> (or <code>IS NULL</code>) are included. This filter is applied at the movie level, not the section level. The parameter accepts either a content rating ID (UUID) or name (e.g., "PG-13", "R").</li>
                            <li>When <code>showInactive=true</code>, sections with <code>isActive=false</code> are included in the response</li>
                            <li>For query-based sections, if query execution fails, the section will have an empty <code>movies</code> array and may include a <code>queryError</code> field</li>
                            <li>For manual sections, movies are always included (filtered by maxContentRating if applicable)</li>
                        </ul>
                    </div>
                    <h4>Style Configuration:</h4>
                    <p>The <code>styleConfig</code> field contains styling and animation configuration for sections. For hero sections, it includes <code>titleImageTransition</code> which controls how title images animate onto the screen.</p>
                    <h5>Title Image Transition Options:</h5>
                    <table>
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>type</code></td>
                                <td>string</td>
                                <td>Transition type: <code>fade</code>, <code>slide-up</code>, <code>slide-down</code>, <code>slide-left</code>, <code>slide-right</code>, <code>scale</code>, <code>fade-scale</code>, <code>fade-slide-up</code>, <code>zoom-in</code>, or <code>none</code></td>
                            </tr>
                            <tr>
                                <td><code>duration</code></td>
                                <td>number</td>
                                <td>Duration in milliseconds (0-2000)</td>
                            </tr>
                            <tr>
                                <td><code>easing</code></td>
                                <td>string</td>
                                <td>CSS easing function: <code>linear</code>, <code>ease</code>, <code>ease-in</code>, <code>ease-out</code>, <code>ease-in-out</code>, or custom cubic-bezier</td>
                            </tr>
                            <tr>
                                <td><code>delay</code></td>
                                <td>number</td>
                                <td>Optional delay in milliseconds (0-1000) before animation starts</td>
                            </tr>
                            <tr>
                                <td><code>distance</code></td>
                                <td>number</td>
                                <td>Optional distance in pixels (0-200) for slide animations</td>
                            </tr>
                            <tr>
                                <td><code>scaleFrom</code></td>
                                <td>number</td>
                                <td>Optional starting scale (0.0-2.0) for scale animations</td>
                            </tr>
                            <tr>
                                <td><code>scaleTo</code></td>
                                <td>number</td>
                                <td>Optional ending scale (0.0-2.0) for scale animations</td>
                            </tr>
                        </tbody>
                    </table>
                    <h5>Example Style Configurations:</h5>
                    <pre><code class="language-json">// Hero section with title image transition
{
  "titleImageTransition": {
    "type": "fade-slide-up",
    "duration": 700,
    "easing": "ease-out",
    "delay": 200,
    "distance": 30
  },
  "background": "dark",
  "showIndicators": true
}

// Carousel section
{
  "background": "transparent",
  "showArrows": true,
  "showDots": true,
  "cardVariant": "poster",
  "spacing": "normal",
  "gap": 16
}</code></pre>
                    <div class="info-box">
                        <strong>Platform-Specific Image Sizes:</strong> The API automatically returns appropriate image resolutions based on the platform parameter:
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li><strong>Mobile:</strong> Returns <code>MEDIUM</code> resolution images for <code>posterUrl</code> and <code>backdropUrl</code></li>
                            <li><strong>Web/TV:</strong> Returns <code>LARGE</code> resolution images for <code>posterUrl</code> and <code>backdropUrl</code></li>
                        </ul>
                        Falls back to <code>ORIGINAL</code> if the preferred resolution is not available. See <a href="docs/section-style-config.md" target="_blank">Section Style Configuration Guide</a> for complete documentation.
                    </div>
                </div>
            </section>

            <!-- Content Service: Streaming API -->
            <section id="stream-api" class="section">
                <h2>Streaming API</h2>
                <p>Manage streaming sessions for video playback. Supports device-based slot management (one stream per device category: mobile, tablet, TV, web).</p>
                <div class="info-box" style="margin-bottom: 1.5rem;">
                    <strong>Route Prefix:</strong> Streaming routes are mounted at <code>/api/content/stream</code>
                </div>
                <!-- <div class="info-box warning" style="margin-bottom: 1.5rem;">
                    <strong>Redis Required:</strong> Streaming functionality requires Redis to be available. If Redis is unavailable, streaming endpoints will return an error.
                </div> -->

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/stream/can-start</span>
                    </div>
                    <div class="endpoint-description">Check if user can start a new stream</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>deviceType</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Check if a specific device type category has an available slot</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "canStart": true,
    "deviceSlots": {
      "used": ["mobile", "tv"],
      "available": ["tablet", "web"],
      "total": 4
    },
    "canStartSpecific": true,
    "specificCategory": "mobile"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/content/stream/start</span>
                    </div>
                    <div class="endpoint-description">Start a new streaming session</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "contentId": "movie-uuid",
  "profileId": "profile-uuid",
  "deviceId": "device-uuid", // required - unique device identifier
  "deviceType": "mobile", // required - "mobile" | "tablet" | "tv" | "web" | "other"
  "deviceName": "iPhone 15 Pro", // required - human-readable device name
  "deviceModel": "iPhone15,2", 
  "appVersion": "1.0.0" 
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "sessionToken": "session-token-xxxxx",
    "streamUrl": "https://stream.vaki-ott.com/content/movie-uuid/playlist.m3u8",
    "expiresAt": "2025-01-15T11:00:00.000Z",
    "heartbeatInterval": 30000, // in milliseconds (e.g., 30000 = 30 seconds)
    "deviceCategory": "mobile",
    "activeCategories": ["mobile"],
    "availableCategories": ["tablet", "tv", "web"],
    "rental": {
      "rentalId": "rental-uuid",
      "expiresAt": "2025-01-17T10:30:00.000Z",
      "gracePeriodEndsAt": "2025-01-17T11:30:00.000Z",
      "isInGracePeriod": false
    }
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Device Categories:</strong> The system limits one active stream per device category (mobile, tablet, TV, web). If you try to start a stream on a device category that's already in use, you'll receive a <code>409 Conflict</code> error with details about the blocking session.
                    </div>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Rental Access:</strong> If the content requires a rental and the user doesn't have an active rental, the endpoint returns <code>403 Forbidden</code> with rental information. You should redirect the user to the payment flow.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/content/stream/heartbeat</span>
                    </div>
                    <div class="endpoint-description">Send heartbeat to keep session alive (must be called at the interval specified in <code>heartbeatInterval</code> from the start response, typically every 30 seconds)</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "sessionToken": "session-token-xxxxx",
  "position": 120, //   current playback position in seconds
  "quality": "1080p", // - current video quality
  "bufferHealth": 10 // optional - buffer health in seconds
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "valid": true,
    "nextHeartbeat": 30000 // in milliseconds (e.g., 30000 = 30 seconds)
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Heartbeat Requirements:</strong> Send heartbeat at the interval specified in <code>heartbeatInterval</code> (typically 30000 milliseconds / 30 seconds) during active playback. If heartbeat is not received for 90 seconds, the session expires. Rate limiting applies - too many requests will return <code>429 Too Many Requests</code>.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/content/stream/stop</span>
                    </div>
                    <div class="endpoint-description">Stop a streaming session</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body:</h4>
                    <pre><code class="language-json">{
  "sessionToken": "session-token-xxxxx",
  "position": 3600, //  final playback position in seconds
  "watchDuration": 3600 // total watch time in seconds
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "watchDuration": 3600,
    "maxPosition": 3600,
    "message": "Stream stopped successfully"
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/stream/active</span>
                    </div>
                    <div class="endpoint-description">Get all active streaming sessions for the user</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <p><strong>Optional Header:</strong> <span class="inline-code">x-device-id: &lt;device-id&gt;</span> - Marks sessions from this device as current</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "sessions": [
      {
        "sessionToken": "session-token-xxxxx",
        "deviceName": "iPhone 15 Pro",
        "deviceType": "mobile",
        "deviceCategory": "mobile",
        "contentId": "movie-uuid",
        "contentTitle": "Movie Title",
        "startedAt": "2025-01-15T10:30:00.000Z",
        "isCurrentDevice": true
      }
    ],
    "deviceSlots": {
      "used": ["mobile", "tv"],
      "available": ["tablet", "web"],
      "total": 4
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-post">POST</span>
                        <span class="endpoint-path">/api/content/stream/force-logout</span>
                    </div>
                    <div class="endpoint-description">Force logout other streaming sessions</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Request Body (one of the following):</h4>
                    <p>Terminate specific sessions:</p>
                    <pre><code class="language-json">{
  "sessionTokens": ["session-token-xxxxx", "session-token-yyyyy"]
}</code></pre>
                    <p>Keep only sessions from a specific device:</p>
                    <pre><code class="language-json">{
  "keepDeviceId": "device-uuid"
}</code></pre>
                    <p>Logout all sessions:</p>
                    <pre><code class="language-json">{
  "logoutAll": true
}</code></pre>
                    <p>Logout specific device category:</p>
                    <pre><code class="language-json">{
  "deviceCategory": "mobile"
}</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "message": "Sessions terminated successfully",
  "data": {
    "terminatedCount": 2,
    "deviceSlots": {
      "used": ["web"],
      "available": ["mobile", "tablet", "tv"]
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/stream/history</span>
                    </div>
                    <div class="endpoint-description">Get streaming history for analytics</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>page</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Page number (default: 1)</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>No</td>
                                <td>Items per page (default: 20, max: 100)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "data": [
      {
        "id": "session-uuid",
        "contentId": "movie-uuid",
        "contentTitle": "Movie Title",
        "contentType": "movie",
        "deviceName": "iPhone 15 Pro",
        "deviceType": "mobile",
        "startedAt": "2025-01-15T10:30:00.000Z",
        "endedAt": "2025-01-15T11:30:00.000Z",
        "watchDuration": 3600,
        "maxPosition": 3600,
        "endReason": "user_stopped"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/stream/continue-watching</span>
                    </div>
                    <div class="endpoint-description">Get continue watching items with progress and thumbnail. Returns content the user has watched (both active and historical sessions) with last viewed position.</div>
                    <p><strong>Headers:</strong> <span class="inline-code">Authorization: Bearer &lt;token&gt;</span></p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "items": [
      {
        "contentId": "movie-uuid",
        "contentTitle": "Movie Title",
        "progress": 1234, // Last viewed position in seconds
        "duration": 5400, // Total duration in seconds
        "percentageCompletion": 23, // Completion percentage (0-100)
        "thumbnailUrl": "https://cdn.example.com/posters/movie-uuid.jpg", // Primary poster URL (same as posterUrl)
        "posterUrl": "https://cdn.example.com/posters/movie-uuid.jpg", // Primary poster URL
        "backdropUrl": "https://cdn.example.com/backdrops/movie-uuid.jpg", // Primary backdrop URL
        "deviceName": "iPhone 15 Pro", // null if not currently active
        "deviceType": "mobile", // null if not currently active
        "deviceCategory": "mobile", // null if not currently active
        "lastWatchedAt": "2025-01-15T10:30:00.000Z"
      }
    ]
  }
}</code></pre>
                    <div class="info-box" style="margin-top: 1rem;">
                        <strong>Notes:</strong>
                        <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                            <li>Returns both active sessions (from Redis) and historical sessions (from PostgreSQL)</li>
                            <li>For active sessions, uses current position from Redis</li>
                            <li>For historical sessions, uses last position from the most recent session</li>
                            <li>Only includes content with progress > 30 seconds and completion < 95%</li>
                            <li>Sorted by most recently watched</li>
                            <li>If Redis is unavailable, falls back to historical data only</li>
                        </ul>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 2rem;">
                    <strong>Streaming Flow:</strong>
                    <ol style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Check if user can start a stream: <code>GET /api/content/stream/can-start</code></li>
                        <li>Start streaming session: <code>POST /api/content/stream/start</code> - returns <code>sessionToken</code> and <code>streamUrl</code></li>
                        <li>Begin playback using the <code>streamUrl</code></li>
                        <li>Send heartbeat every 30 seconds: <code>POST /api/content/stream/heartbeat</code> with <code>sessionToken</code> and <code>position</code></li>
                        <li>When playback stops: <code>POST /api/content/stream/stop</code> with final position</li>
                        <li>Get continue watching list: <code>GET /api/content/stream/continue-watching</code> to show user's watch progress</li>
                    </ol>
                </div>

                <div class="info-box" style="margin-top: 1rem;">
                    <strong>Session Management:</strong>
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Sessions expire after 90 seconds without heartbeat</li>
                        <li>One stream per device category (mobile, tablet, TV, web)</li>
                        <li>Use <code>GET /api/content/stream/active</code> to see all active sessions</li>
                        <li>Use <code>POST /api/content/stream/force-logout</code> to terminate other sessions if needed</li>
                        <li>Same device can reconnect - old session is automatically replaced</li>
                    </ul>
                </div>
            </section>

            <!-- Content Service: References API -->
            <section id="references-api" class="section">
                <h2>References API</h2>
                <p>Get metadata lookups for genres, languages, content ratings, and people.</p>
                <div class="info-box warning">
                    <strong>Note:</strong> Content categories have been removed. Content classification is now handled through <code>genres</code> and the <code>mediaType</code> field. Use genres for content classification instead of categories.
                </div>

                <h3>Genres</h3>
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/genres</span>
                    </div>
                    <div class="endpoint-description">Get genres with optional filters</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>includeInactive</code></td>
                                <td>boolean</td>
                                <td>Include inactive genres</td>
                            </tr>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search genres by name</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "genre-uuid",
      "name": "Action",
      "slug": "action",
      "displayOrder": 1,
      "isActive": true,
      "createdAt": "2025-01-01T00:00:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/genres/:id</span>
                    </div>
                    <div class="endpoint-description">Get single genre by ID</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "genre-uuid",
    "name": "Action",
    "slug": "action",
    "displayOrder": 1,
    "isActive": true,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-01T00:00:00.000Z"
  }
}</code></pre>
                </div>

                <h3>Languages</h3>
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/languages</span>
                    </div>
                    <div class="endpoint-description">Get languages with optional search</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search languages by name or code</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "language-uuid",
      "name": "English",
      "code": "en",
      "isActive": true,
      "createdAt": "2025-01-01T00:00:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/languages/:id</span>
                    </div>
                    <div class="endpoint-description">Get single language by ID</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "language-uuid",
    "name": "English",
    "code": "en",
    "isActive": true,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-01T00:00:00.000Z"
  }
}</code></pre>
                </div>

                <h3>Content Ratings</h3>
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/content-ratings</span>
                    </div>
                    <div class="endpoint-description">Get all content ratings</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "rating-uuid",
      "name": "PG-13",
      "description": "Parents Strongly Cautioned",
      "isActive": true,
      "createdAt": "2025-01-01T00:00:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/content-ratings/:id</span>
                    </div>
                    <div class="endpoint-description">Get single content rating by ID</div>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "rating-uuid",
    "name": "PG-13",
    "description": "Parents Strongly Cautioned",
    "isActive": true,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "updatedAt": "2025-01-01T00:00:00.000Z"
  }
}</code></pre>
                </div>

                <h3>People (Directors, Actors, Producers)</h3>
                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/directors</span>
                    </div>
                    <div class="endpoint-description">Search directors</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search by name</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>Limit results</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "director-uuid",
      "name": "Director Name",
      "slug": "director-name",
      "isActive": true
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/directors/:id</span>
                    </div>
                    <div class="endpoint-description">Get director profile by ID with associated movies</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>includeMovies</code></td>
                                <td>boolean</td>
                                <td>No</td>
                                <td>Include associated movies in response (default: <code>true</code>). Set to <code>false</code> to exclude movies.</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/references/directors/director-uuid
GET /api/content/references/directors/director-uuid?includeMovies=false</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "director-uuid",
    "name": "Director Name",
    "slug": "director-name",
    "bio": "Director biography",
    "isActive": true,
    "photo": "https://cdn.example.com/directors/director-uuid.jpg",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "movies": [
      {
        "id": "movie-uuid",
        "title": "Movie Title",
        "slug": "movie-title",
        "description": "Movie description",
        "mediaType": "movie",
        "contentRating": {
          "id": "rating-uuid",
          "name": "PG-13"
        },
        "posterUrl": "https://cdn.example.com/movies/movie-uuid/poster.jpg",
        "backdropUrl": "https://cdn.example.com/movies/movie-uuid/backdrop.jpg"
      }
    ]
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Movies are included by default. The <code>movies</code> array contains all movies directed by this director, ordered by creation date (newest first). Each movie includes only essential fields: <code>id</code>, <code>title</code>, <code>slug</code>, <code>description</code>, <code>mediaType</code>, <code>contentRating</code>, <code>posterUrl</code>, and <code>backdropUrl</code>. Set <code>includeMovies=false</code> to exclude movies from the response.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/actors</span>
                    </div>
                    <div class="endpoint-description">Search actors</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search by name</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>Limit results (default: 20, max: 100)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "actor-uuid",
      "name": "Actor Name",
      "slug": "actor-name",
      "bio": "Actor biography",
      "isActive": true,
      "createdAt": "2025-01-01T00:00:00.000Z"
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/actors/:id</span>
                    </div>
                    <div class="endpoint-description">Get actor profile by ID with associated movies</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>includeMovies</code></td>
                                <td>boolean</td>
                                <td>No</td>
                                <td>Include associated movies in response (default: <code>true</code>). Set to <code>false</code> to exclude movies.</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/references/actors/actor-uuid
GET /api/content/references/actors/actor-uuid?includeMovies=false</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "actor-uuid",
    "name": "Actor Name",
    "slug": "actor-name",
    "bio": "Actor biography",
    "isActive": true,
    "photo": "https://cdn.example.com/actors/actor-uuid.jpg",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "movies": [
      {
        "id": "movie-uuid",
        "title": "Movie Title",
        "slug": "movie-title",
        "description": "Movie description",
        "mediaType": "movie",
        "contentRating": {
          "id": "rating-uuid",
          "name": "PG-13"
        },
        "posterUrl": "https://cdn.example.com/movies/movie-uuid/poster.jpg",
        "backdropUrl": "https://cdn.example.com/movies/movie-uuid/backdrop.jpg"
      }
    ]
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Movies are included by default. The <code>movies</code> array contains all movies featuring this actor, ordered by creation date (newest first). Each movie includes only essential fields: <code>id</code>, <code>title</code>, <code>slug</code>, <code>description</code>, <code>mediaType</code>, <code>contentRating</code>, <code>posterUrl</code>, and <code>backdropUrl</code>. Set <code>includeMovies=false</code> to exclude movies from the response.
                    </div>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/producers</span>
                    </div>
                    <div class="endpoint-description">Search producers</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>search</code></td>
                                <td>string</td>
                                <td>Search by name</td>
                            </tr>
                            <tr>
                                <td><code>limit</code></td>
                                <td>number</td>
                                <td>Limit results</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "producer-uuid",
      "name": "Producer Name",
      "slug": "producer-name",
      "isActive": true
    }
  ]
}</code></pre>
                </div>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/references/producers/:id</span>
                    </div>
                    <div class="endpoint-description">Get producer profile by ID with associated movies</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>includeMovies</code></td>
                                <td>boolean</td>
                                <td>No</td>
                                <td>Include associated movies in response (default: <code>true</code>). Set to <code>false</code> to exclude movies.</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/references/producers/producer-uuid
GET /api/content/references/producers/producer-uuid?includeMovies=false</code></pre>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": {
    "id": "producer-uuid",
    "name": "Producer Name",
    "slug": "producer-name",
    "bio": "Producer biography",
    "isActive": true,
    "photo": "https://cdn.example.com/producers/producer-uuid.jpg",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "movies": [
      {
        "id": "movie-uuid",
        "title": "Movie Title",
        "slug": "movie-title",
        "description": "Movie description",
        "mediaType": "movie",
        "contentRating": {
          "id": "rating-uuid",
          "name": "PG-13"
        },
        "posterUrl": "https://cdn.example.com/movies/movie-uuid/poster.jpg",
        "backdropUrl": "https://cdn.example.com/movies/movie-uuid/backdrop.jpg"
      }
    ]
  }
}</code></pre>
                    <div class="info-box">
                        <strong>Note:</strong> Movies are included by default. The <code>movies</code> array contains all movies produced by this producer, ordered by creation date (newest first). Each movie includes only essential fields: <code>id</code>, <code>title</code>, <code>slug</code>, <code>description</code>, <code>mediaType</code>, <code>contentRating</code>, <code>posterUrl</code>, and <code>backdropUrl</code>. Set <code>includeMovies=false</code> to exclude movies from the response.
                    </div>
                </div>
            </section>

            <!-- Content Service: People API -->
            <section id="people-api" class="section">
                <h2>People Search API</h2>
                <p>Unified search across directors, actors, and producers.</p>

                <div class="endpoint">
                    <div class="endpoint-header">
                        <span class="badge badge-get">GET</span>
                        <span class="endpoint-path">/api/content/people/search</span>
                    </div>
                    <div class="endpoint-description">Search across all people types</div>
                    <h4>Query Parameters:</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>q</code></td>
                                <td>string</td>
                                <td>Yes</td>
                                <td>Search query</td>
                            </tr>
                            <tr>
                                <td><code>type</code></td>
                                <td>string</td>
                                <td>No</td>
                                <td>Filter by type: <code>all</code>, <code>directors</code>, <code>actors</code>, <code>producers</code> (default: <code>all</code>)</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code class="language-bash">GET /api/content/people/search?q=raj&type=directors</code></pre>
                    <p>Returns up to 10 matches per type.</p>
                    <h4>Response:</h4>
                    <pre><code class="language-json">{
  "success": true,
  "data": [
    {
      "id": "director-uuid",
      "name": "Raj Kumar",
      "slug": "raj-kumar",
      "type": "director"
    },
    {
      "id": "actor-uuid",
      "name": "Raj Kapoor",
      "slug": "raj-kapoor",
      "type": "actor"
    },
    {
      "id": "producer-uuid",
      "name": "Raj Productions",
      "slug": "raj-productions",
      "type": "producer"
    }
  ]
}</code></pre>
                </div>
            </section>

            <!-- Error Handling -->
            <section id="error-handling" class="section">
                <h2>Error Handling</h2>
                <p>All API endpoints return errors in a consistent format:</p>
                <pre><code class="language-json">{
  "error": "Error message",
  "path": "/api/content/movies",
  "method": "GET",
  "status": 404,
  "timestamp": "2025-01-15T10:30:00.000Z"
}</code></pre>

                <h3>Common HTTP Status Codes</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Status Code</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>200</code></td>
                            <td>Success</td>
                        </tr>
                        <tr>
                            <td><code>201</code></td>
                            <td>Created</td>
                        </tr>
                        <tr>
                            <td><code>400</code></td>
                            <td>Bad Request</td>
                        </tr>
                        <tr>
                            <td><code>401</code></td>
                            <td>Unauthorized (missing or invalid token)</td>
                        </tr>
                        <tr>
                            <td><code>403</code></td>
                            <td>Forbidden (insufficient permissions)</td>
                        </tr>
                        <tr>
                            <td><code>404</code></td>
                            <td>Not Found</td>
                        </tr>
                        <tr>
                            <td><code>429</code></td>
                            <td>Too Many Requests (rate limit exceeded)</td>
                        </tr>
                        <tr>
                            <td><code>500</code></td>
                            <td>Internal Server Error</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box warning">
                    <strong>Rate Limiting:</strong> The API enforces rate limiting (100 requests per 15 minutes). If you exceed this limit, you'll receive a 429 status code.
                </div>
            </section>

            <!-- Example Usage -->
            <section id="example-usage" class="section">
                <h2>Example Usage</h2>
                <p>Here's a complete example of integrating with the API using JavaScript:</p>
                <pre><code class="language-javascript">// Base URL
const API_BASE_URL = 'http://localhost:3010';

// Request OTP
async function requestOTP(email) {
  const response = await fetch(`${API_BASE_URL}/api/otp/email`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ email }),
  });
  return response.json();
}

// Login with OTP
async function login(identifier, code) {
  const response = await fetch(`${API_BASE_URL}/api/auth/login`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      identifier,
      code,
      deviceName: 'Web Browser',
      deviceType: 'web',
    }),
  });
  const data = await response.json();
  if (data.success) {
    // Store tokens
    localStorage.setItem('accessToken', data.data.tokens.accessToken);
    localStorage.setItem('refreshToken', data.data.tokens.refreshToken);
  }
  return data;
}

// Register and Login (unified - creates account if user doesn't exist)
async function registerAndLogin(identifier, code, deviceInfo = {}, profileInfo = null) {
  const response = await fetch(`${API_BASE_URL}/api/auth/register-and-login`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      identifier,
      code,
      deviceName: deviceInfo.deviceName || 'Web Browser',
      deviceType: deviceInfo.deviceType || 'web',
      deviceId: deviceInfo.deviceId,
      phoneNumberExtension: deviceInfo.phoneNumberExtension,
      profile: profileInfo, // Optional: for new users
    }),
  });
  const data = await response.json();
  if (data.success) {
    // Store tokens
    localStorage.setItem('accessToken', data.data.tokens.accessToken);
    localStorage.setItem('refreshToken', data.data.tokens.refreshToken);
  }
  return data;
}

// Get movies (public endpoint)
async function getMovies(page = 1, limit = 20) {
  const response = await fetch(
    `${API_BASE_URL}/api/content/movies?page=${page}&limit=${limit}&status=published`
  );
  return response.json();
}

// Get reels (public endpoint)
async function getReels(page = 1, limit = 20) {
  const response = await fetch(
    `${API_BASE_URL}/api/content/reels?page=${page}&limit=${limit}&status=published`
  );
  return response.json();
}

// Get sections for a context and platform
async function getSections(context = 'home', platform = 'web', options = {}) {
  const { maxContentRating, showInactive } = options;
  const params = new URLSearchParams({
    context,
    platform,
  });
  
  if (maxContentRating) {
    params.append('maxContentRating', maxContentRating);
  }
  
  if (showInactive === true) {
    params.append('showInactive', 'true');
  }
  
  const response = await fetch(
    `${API_BASE_URL}/api/content/sections?${params.toString()}`
  );
  return response.json();
}

// Get home sections (backward compatibility - uses new endpoint)
async function getHomeSections(platform = 'web', options = {}) {
  return getSections('home', platform, options);
}

// Example: Get sections with maxContentRating filter (by rating name)
async function getSectionsByRating(context = 'home', platform = 'web', ratingName = 'PG-13') {
  return getSections(context, platform, { maxContentRating: ratingName });
}

// Example: Get sections with maxContentRating filter (by rating ID)
async function getSectionsByRatingId(context = 'home', platform = 'web', ratingId) {
  return getSections(context, platform, { maxContentRating: ratingId });
}

// Authenticated request helper
async function authenticatedFetch(endpoint, options = {}) {
  const token = localStorage.getItem('accessToken');
  const response = await fetch(`${API_BASE_URL}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      Authorization: `Bearer ${token}`,
      ...options.headers,
    },
  });
  
  // Handle token refresh if needed
  if (response.status === 401) {
    // Try to refresh token
    const refreshToken = localStorage.getItem('refreshToken');
    const refreshResponse = await fetch(`${API_BASE_URL}/api/auth/refresh`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ refreshToken }),
    });
    
    if (refreshResponse.ok) {
      const refreshData = await refreshResponse.json();
      localStorage.setItem('accessToken', refreshData.data.tokens.accessToken);
      localStorage.setItem('refreshToken', refreshData.data.tokens.refreshToken);
      // Retry original request
      return authenticatedFetch(endpoint, options);
    }
  }
  
  return response;
}

// Get current user
async function getCurrentUser() {
  const response = await authenticatedFetch('/api/auth/me');
  return response.json();
}

// Get user profiles
async function getUserProfiles() {
  const response = await authenticatedFetch('/api/users/me/profiles');
  return response.json();
}

// Watch Later functions
async function getWatchLater(profileId, page = 1, limit = 20) {
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later?page=${page}&limit=${limit}`
  );
  return response.json();
}

// Add movie/short film/documentary/BTS/reel to watch later
async function addMovieToWatchLater(profileId, contentType, contentId) {
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later`,
    {
      method: 'POST',
      body: JSON.stringify({ contentType, contentId }),
    }
  );
  return response.json();
}

// Add series to watch later
async function addSeriesToWatchLater(profileId, seriesId) {
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later`,
    {
      method: 'POST',
      body: JSON.stringify({ contentType: 'series', seriesId }),
    }
  );
  return response.json();
}

// Add episode to watch later
async function addEpisodeToWatchLater(profileId, episodeId) {
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later`,
    {
      method: 'POST',
      body: JSON.stringify({ contentType: 'episode', episodeId }),
    }
  );
  return response.json();
}

// Remove content from watch later
async function removeFromWatchLater(profileId, contentType, contentId, seriesId, episodeId) {
  const body = { contentType };
  if (contentId) body.contentId = contentId;
  if (seriesId) body.seriesId = seriesId;
  if (episodeId) body.episodeId = episodeId;
  
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later`,
    {
      method: 'DELETE',
      body: JSON.stringify(body),
    }
  );
  return response.json();
}

// Check if content is in watch later
async function checkWatchLater(profileId, contentType, contentId, seriesId, episodeId) {
  const params = new URLSearchParams({ contentType });
  if (contentId) params.append('contentId', contentId);
  if (seriesId) params.append('seriesId', seriesId);
  if (episodeId) params.append('episodeId', episodeId);
  
  const response = await authenticatedFetch(
    `/api/users/me/profiles/${profileId}/watch-later/check?${params.toString()}`
  );
  return response.json();
}

// Payment functions
async function getPaymentConfig() {
  const response = await fetch(`${API_BASE_URL}/api/payments/config`);
  return response.json();
}

async function getContentPricing(contentType, contentId) {
  const response = await fetch(`${API_BASE_URL}/api/payments/pricing/${contentType}/${contentId}`);
  return response.json();
}

async function createPayment(contentId, contentType = 'movie', durationHours = 24, platform = 'web') {
  const response = await authenticatedFetch('/api/payments/create', {
    method: 'POST',
    body: JSON.stringify({ contentId, contentType, durationHours, platform }),
  });
  return response.json();
}

async function verifyPayment(paymentId, gatewayData) {
  const response = await authenticatedFetch('/api/payments/verify', {
    method: 'POST',
    body: JSON.stringify({
      paymentId,
      gatewayOrderId: gatewayData.orderId,
      gatewayPaymentId: gatewayData.paymentId,
      gatewaySignature: gatewayData.signature,
    }),
  });
  return response.json();
}

async function getRentalStatus(contentId, type = 'movie') {
  const response = await authenticatedFetch(
    `/api/payments/rental-status/${contentId}?type=${type}`
  );
  return response.json();
}

async function getActiveRentals() {
  const response = await authenticatedFetch('/api/payments/rentals/active');
  return response.json();
}

async function getPaymentHistory(page = 1, limit = 20) {
  const response = await authenticatedFetch(
    `/api/payments/history?page=${page}&limit=${limit}`
  );
  return response.json();
}

async function getPaymentStatus(paymentId) {
  const response = await authenticatedFetch(`/api/payments/${paymentId}`);
  return response.json();
}

// Example: Complete payment flow with RazorPay
async function rentContent(contentId, contentType = 'movie') {
  try {
    // Step 1: Create payment order
    const createResponse = await createPayment(contentId, contentType);
    if (!createResponse.success) {
      throw new Error(createResponse.error || 'Failed to create payment');
    }

    const { paymentId, paymentData, gateway } = createResponse.data;

    if (gateway === 'razorpay') {
      // Step 2: Initialize RazorPay checkout
      const options = {
        key: paymentData.keyId,
        amount: paymentData.amount,
        currency: paymentData.currency,
        order_id: paymentData.orderId,
        name: 'Vaki OTT',
        description: 'Content Rental',
        handler: async function(response) {
          // Step 3: Verify payment after RazorPay success
          const verifyResponse = await verifyPayment(paymentId, {
            orderId: response.razorpay_order_id,
            paymentId: response.razorpay_payment_id,
            signature: response.razorpay_signature,
          });
          
          if (verifyResponse.success) {
            console.log('Payment verified, rental activated!', verifyResponse.data);
            return verifyResponse;
          } else {
            throw new Error(verifyResponse.error || 'Payment verification failed');
          }
        },
        prefill: {
          // Pre-fill user details if available
        },
        theme: {
          color: '#635bff'
        }
      };
      
      const razorpay = new Razorpay(options);
      razorpay.open();
      
      return { paymentId, paymentData };
    } else if (gateway === 'apple_pay') {
      // Handle Apple Pay flow
      // This requires Apple Pay JS SDK integration
      return { paymentId, requiresClientSidePayment: true };
    }
  } catch (error) {
    console.error('Payment error:', error);
    throw error;
  }
}

// Streaming functions
async function canStartStream(deviceType) {
  const params = deviceType ? `?deviceType=${deviceType}` : '';
  const response = await authenticatedFetch(`/api/content/stream/can-start${params}`);
  return response.json();
}

async function startStream(contentId, deviceInfo, profileId) {
  const response = await authenticatedFetch('/api/content/stream/start', {
    method: 'POST',
    body: JSON.stringify({
      contentId,
      profileId,
      deviceId: deviceInfo.deviceId,
      deviceType: deviceInfo.deviceType,
      deviceName: deviceInfo.deviceName,
      deviceModel: deviceInfo.deviceModel,
      appVersion: deviceInfo.appVersion,
    }),
  });
  return response.json();
}

async function sendHeartbeat(sessionToken, position, quality, bufferHealth) {
  const response = await authenticatedFetch('/api/content/stream/heartbeat', {
    method: 'POST',
    body: JSON.stringify({
      sessionToken,
      position,
      quality,
      bufferHealth,
    }),
  });
  return response.json();
}

async function stopStream(sessionToken, position, watchDuration) {
  const response = await authenticatedFetch('/api/content/stream/stop', {
    method: 'POST',
    body: JSON.stringify({
      sessionToken,
      position,
      watchDuration,
    }),
  });
  return response.json();
}

async function getActiveSessions(deviceId) {
  const headers = deviceId ? { 'x-device-id': deviceId } : {};
  const response = await authenticatedFetch('/api/content/stream/active', {
    headers,
  });
  return response.json();
}

async function forceLogoutSessions(options) {
  const response = await authenticatedFetch('/api/content/stream/force-logout', {
    method: 'POST',
    body: JSON.stringify(options),
  });
  return response.json();
}

async function getStreamHistory(page = 1, limit = 20) {
  const response = await authenticatedFetch(
    `/api/content/stream/history?page=${page}&limit=${limit}`
  );
  return response.json();
}

async function getContinueWatching() {
  const response = await authenticatedFetch('/api/content/stream/continue-watching');
  return response.json();
}

// Example: Complete streaming flow
let heartbeatInterval = null;
let currentSessionToken = null;

async function playContent(contentId, deviceInfo, profileId) {
  try {
    // Step 1: Check if can start stream
    const canStart = await canStartStream(deviceInfo.deviceType);
    if (!canStart.data.canStart) {
      throw new Error('Cannot start stream - device slot taken');
    }

    // Step 2: Start streaming session
    const startResponse = await startStream(contentId, deviceInfo, profileId);
    if (!startResponse.success) {
      if (startResponse.error === 'RENTAL_REQUIRED') {
        // Redirect to payment flow
        throw new Error('Rental required');
      }
      throw new Error(startResponse.error || 'Failed to start stream');
    }

    const { sessionToken, streamUrl, heartbeatInterval: interval } = startResponse.data;
    currentSessionToken = sessionToken;

    // Step 3: Start video player with streamUrl
    // videoPlayer.src = streamUrl;
    // videoPlayer.play();

    // Step 4: Start heartbeat interval (heartbeatInterval is in milliseconds)
    heartbeatInterval = setInterval(async () => {
      try {
        const position = Math.floor(videoPlayer.currentTime || 0);
        await sendHeartbeat(sessionToken, position);
      } catch (error) {
        console.error('Heartbeat failed:', error);
        // Session might have expired - stop playback
        if (error.status === 401) {
          clearInterval(heartbeatInterval);
          // Handle session expired
        }
      }
    }, interval); // interval is already in milliseconds

    return { sessionToken, streamUrl };
  } catch (error) {
    console.error('Streaming error:', error);
    throw error;
  }
}

async function stopPlayback() {
  if (heartbeatInterval) {
    clearInterval(heartbeatInterval);
    heartbeatInterval = null;
  }

  if (currentSessionToken) {
    const position = Math.floor(videoPlayer.currentTime || 0);
    const watchDuration = Math.floor(videoPlayer.duration || 0);
    await stopStream(currentSessionToken, position, watchDuration);
    currentSessionToken = null;
  }
}</code></pre>
            </section>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    // Update active nav link
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                    });
                    this.classList.add('active');
                }
            });
        });

        // Highlight active section in sidebar
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.nav-link');

        function updateActiveNav() {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        }

        window.addEventListener('scroll', updateActiveNav);
        updateActiveNav();

        // Make endpoints collapsible
        document.querySelectorAll('.endpoint').forEach(endpoint => {
            const header = endpoint.querySelector('.endpoint-header');
            if (!header) return;

            // Check if already processed
            if (endpoint.querySelector('.endpoint-toggle')) return;

            // Create toggle button
            const toggle = document.createElement('div');
            toggle.className = 'endpoint-toggle';
            toggle.innerHTML = '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>';
            header.appendChild(toggle);

            // Find description and keep it outside content div
            const description = endpoint.querySelector('.endpoint-description');
            
            // Wrap content after description (or header if no description) in endpoint-content div
            const content = document.createElement('div');
            content.className = 'endpoint-content';
            
            // Start from description's next sibling, or header's next sibling if no description
            const startNode = description ? description.nextSibling : header.nextSibling;
            if (startNode) {
                let node = startNode;
                while (node) {
                    const nextNode = node.nextSibling;
                    content.appendChild(node);
                    node = nextNode;
                }
                endpoint.appendChild(content);
            }

            // Add click handler
            header.addEventListener('click', () => {
                endpoint.classList.toggle('collapsed');
            });
        });

        // Dark mode toggle
        const themeToggle = document.getElementById('themeToggle');
        const sunIcon = document.getElementById('sunIcon');
        const moonIcon = document.getElementById('moonIcon');
        const html = document.documentElement;

        // Check for saved theme preference or default to light mode
        const currentTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', currentTheme);
        updateThemeIcon(currentTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                sunIcon.style.display = 'block';
                moonIcon.style.display = 'none';
            } else {
                sunIcon.style.display = 'none';
                moonIcon.style.display = 'block';
            }
        }

        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebarOverlay');
        const menuIcon = document.getElementById('menuIcon');
        const closeIcon = document.getElementById('closeIcon');

        function toggleSidebar() {
            sidebar.classList.toggle('open');
            sidebarOverlay.classList.toggle('active');
            
            // Update icon
            if (sidebar.classList.contains('open')) {
                menuIcon.style.display = 'none';
                closeIcon.style.display = 'block';
            } else {
                menuIcon.style.display = 'block';
                closeIcon.style.display = 'none';
            }
        }

        function closeSidebar() {
            sidebar.classList.remove('open');
            sidebarOverlay.classList.remove('active');
            menuIcon.style.display = 'block';
            closeIcon.style.display = 'none';
        }

        // Toggle sidebar on menu button click
        if (menuToggle) {
            menuToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleSidebar();
            });
        }

        // Close sidebar when clicking overlay
        if (sidebarOverlay) {
            sidebarOverlay.addEventListener('click', closeSidebar);
        }

        // Close sidebar when clicking a nav link on mobile
        if (window.innerWidth <= 1024) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    closeSidebar();
                });
            });
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth > 1024) {
                closeSidebar();
            }
        });
    </script>
</body>
</html>

